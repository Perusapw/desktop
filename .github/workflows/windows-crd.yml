name: Windows VPS with Chrome Remote Desktop

on:
  workflow_dispatch: # Menjalankan workflow secara manual

jobs:
  setup-vps:
    runs-on: windows-latest # Menggunakan runner Windows

    steps:
    - name: Buat User Aezteru
      run: |
        net user Aezteru /add
        net localgroup administrators Aezteru /add
        echo "User Aezteru berhasil dibuat dan ditambahkan ke grup administrator"

    - name: Install Google Chrome
      run: |
        curl -O https://dl.google.com/chrome/install/latest/chrome_installer.exe
        start chrome_installer.exe /silent /install
        echo "Google Chrome installed"

    - name: Install Chrome Remote Desktop
      run: |
        echo "Installing Chrome Remote Desktop"
        curl -O https://dl.google.com/linux/direct/chrome-remote-desktop_current_amd64.deb
        start chrome-remote-desktop_current_amd64.deb /silent /install

    - name: Start Chrome Remote Desktop with Authcode
      run: |
        echo "Starting Chrome Remote Desktop with authcode"
        "%PROGRAMFILES(X86)%\Google\Chrome Remote Desktop\CurrentVersion\remoting_start_host.exe" ^
        --code="4/0AVG7fiTdS6DxYA4PsYvM66DW6f7FbimL0kTZ4SiCK5sz7xQSrlGzSCYpWanvNqbrNFpGUQ" ^
        --redirect-url="https://remotedesktop.google.com/_/oauthredirect" ^
        --name=%COMPUTERNAME%
        echo "Chrome Remote Desktop started with user Aezteru and authcode"

    - name: Keep the session alive
      run: |
        echo "Keeping the session alive for 24 hours"
        timeout /t 86400
